---
title: 笔记：OAuth 协议
date: 2025-07-06
categories:
  - Java
  - 安全框架
  - OAuth 规范
tags: 
author: 霸天
layout: post
---
## 1. OAuth2 协议

### 1.1. OAuth2 概述

Auth 表示授权（Authorization），O 表示开放（Open），OAuth2 是一种开放式的授权协议，用于在不暴露用户凭据的前提下，让第三方应用获得访问权限。

![](image-20250706092222409.png)

> [!NOTE] 注意事项
> 1. 客户端应用可能是：前端、后端、移动 APP、微信小程序等

---


### 1.2. OAuth2 中的角色

![](PixPin_2025-07-06_16-38-42.png)

----


### 1.3. OAuth2 的使用场景

----


### 1.4. OAuth2 的四种授权模式

#### 1.4.1. 授权码模式（Authorization Code）

---


#### 1.4.2. 隐藏式（Implicit）

---


#### 1.4.3. 密码式（Password）

---


#### 1.4.4. 客户端凭证模式（Client Credentials）

----


## 2. OAuth2.1 协议

### 2.1. OAuth 2.1 概述

OAuth 2.1 目前仍处于草案阶段，但正逐渐被广泛接受，有望成为主流。其较于 OAuht2 的主要变化包括：
1. 对授权码模式（Authorization Code）进行了增强，引入了 PKCE（授权码交换的密钥证明）。
	1. 需要注意的hi是，OAuth 2.1 明确指出：**只要使用授权码模式，必须同时使用 PKCE**，以提升安全性
2. 移除了不再安全的隐藏式（Implicit）和密码式（Password）授权模式，新增了刷新令牌模式（Refresh Token），OAuth 2.1 最终保留三种主流授权模式：
	1. 授权码模式（Authorization Code）+ PKCE（授权码交换的密钥证明）
	2. 客户端凭证模式（Client Credentials）
	3. 客户端凭证模式（Client Credentials）

----


### 2.2. OAuth2.1 三种授权模式

#### 2.2.1. 授权码模式（Authorization Code）+ PKCE（授权码交换的密钥证明）

---


#### 2.2.2. 客户端凭证模式（Client Credentials）

----


#### 2.2.3. 刷新令牌模式（Refresh Token）

---


## 3. 使用 Spring Security 实现授权码模式 + PKCE

### 3.1. 需求定位

如果你只是接入第三方登录平台，比如在登录极客时间时，选择第三方登录方式“使用微信登录”，那么你只需要开发**客户端应用**：
![](image-20250706220734441.png)

如果你希望像微信一样，为其他系统提供登录能力（即让别人用你平台做第三方登录），那你就需要开发**授权服务器**（负责发 token）和**资源服务器**（负责提供受保护资源）

如果你要开发一整套系统（例如企业内部统一认证平台、SaaS 平台等），那么你就需要同时开发：**客户端应用、授权服务器和资源服务器**，以实现完整的 OAuth2 流程。

----


### 3.2. 接入第三方登录平台

-----


### 3.3. 开发第三方登录平台，供其他应用接入

-----


### 3.4. 开发整套系统

#### 3.4.1. 开发客户端应用

---


#### 3.4.2. 开发授权服务器

----


#### 3.4.3. 开发资源服务器

-----









