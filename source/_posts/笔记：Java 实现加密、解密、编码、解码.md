---
title: 笔记：Java 实现加密、解密、编码、解码
date: 2025-07-03
categories: 
tags: 
author: 霸天
layout: post
---


## 编码

### Base64 编码

#### Base64 编码概述

Base64 使用一个**包含 64 个字符的字符表**，将任意二进制数据映射成可打印字符。简单来说，当我们对字符串 `abc` 进行 Base64 编码时：
```
String original = "abc";
```

在内存中，这个字符串对应的字节数组（UTF‑8）是：
```
[01100001, 01100010, 01100011]
   a                 b              c
```

Base64 的编码过程是将每 3 个字节（24 位） 划分为 4 组×6 位
```
[01100001][01100010][01100011] // 原始字节
		↓↓↓ 拆成 ↓↓↓
[011000][010110][001001][100011] // 每组 6 位
```

然后分别在下面这个 64 字符表中，查表并输出 4 个字符
```
A-Z（26个）  
a-z （26个）  
0-9 （10个）  
+ 和 /
```

这里 abc 在内存中正好就是 3 个字节（24位），然后进行 Base64 编码：
```
String original = "abc";


String encoded = Base64.getEncoder().encodeToString(original.getBytes("UTF-8")); // original.getBytes(StandardCharsets.UTF_8) 返回的是 byte[]，也就是在内存中的二进制数据
```

编码后的结果为：
```
YWJj
```

编码后的结果占用的内存是 **4 字节（32位）**

> [!NOTE] 注意事项
> 1. 编码后字符数 = ((原始字节数 + 2) / 3) × 4   // 注意是整数除法（向下取整、截断小数）
> 2. 在 UTF-8 编码下，一个英文字符占用 1 个字节，因此如果希望 Base64 编码后的字符数为 64 个，那么原始数据的字节数应为 48 字节，也就是 48 个英文字符
> 3. 需要注意的是，Base64 编码结果中可能会出现 `=` 号，它不属于 Base64 的 64 个字符表，这是由于 Base64 是将每 3 字节（24 位）转换成 4 个 Base64 字符（每个字符 6 位），当原始数据长度不是 3 的倍数时（比如剩余 1 或 2 个字节），为了凑满 24 位的长度，使用 `=` 作为填充符号进行补齐。
```
any → YW55（无需补位）

an → YW4=（补 1 个 =）

a → YQ==（补 2 个 =）
```

----


### Base64URL 编码








```
"中"（字符）
   ↓  UTF-8 编码
[E4, B8, AD]（字节）
   ↓  Base64 编码
"5Lit"（字符串）
   ↓ 编译（javac）
Hello.class 字节码

```



|原始字符串长度|字节数（UTF-8）|编码后 Base64 字符数|
|---|---|---|
|3|3|4|
|6|6|8|
|9|9|12|
|48|48|64|
|64|64|88|

> 你那段字符串 `aVeryLongAndSecureSecretKeyThatIsAtLeast64BytesLong`，原始长度是 **53 字节**，Base64 编码后长度是 **72 字符**

---

### ✅ 3. **我们能控制 Base64 的输出长度吗？**

**不能直接控制“精确长度”，但可以“间接控制”**：

- 如果你想编码后长度正好是 **64 字符**，那你就得**控制原始字节数为 48 字节**
    
- 如果你想编码后正好是 **88 字符**，原始长度就要是 **64 字节**
    

💡你可以用这个反向推导公式：

```
原始字节数 = (Base64长度 / 4) * 3
```

所以想编码成 **64 个字符**，就应该：

```
原始长度 = (64 / 4) * 3 = 48 字节
```

---

### 🧪 举例：

```java
byte[] data = new byte[48]; // 48字节
String base64 = Base64.getEncoder().encodeToString(data);
System.out.println(base64.length());  // 输出为64
```

---

### 🔚 总结：

|问题|答案|
|---|---|
|Base64 是固定编码成 64 字节吗？|❌ 不是，64 指的是编码表的字符数|
|编码后长度可控吗？|✅ 可以通过控制原始字节数间接控制|
|Base64 是加密吗？|❌ 不是，只是编码，能被轻松解码|

---

需要我帮你设计一个**原始密钥长度刚好使 Base64 编码后是 64 个字符的字符串**吗？我可以帮你生成。


